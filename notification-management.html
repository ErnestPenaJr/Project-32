<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notification Management</title>
    <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/fontawesome-pro-5.15.4/css/all.css" rel="stylesheet">
    <link href="node_modules/aos/dist/aos.css" rel="stylesheet">
    <link href="node_modules/sweetalert2/dist/sweetalert2.min.css" rel="stylesheet">
    <link href="assets/DataTables-2.1.8/datatables.css" rel="stylesheet">
    <link href="assets/css/styles.css" rel="stylesheet">
</head>

<body>
    <!-- Navigation -->
    <div id="topNav"></div>
    
    <!-- Offcanvas Help Panel -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasExampleLabel">Notification Management</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="mb-3">
                <h4>TABLE OF CONTENTS</h4>
                <ul>
                    <li><a href="#viewingNotifications">Viewing Notifications</a></li>
                    <li><a href="#creatingBulkNotification">Creating Bulk Notifications</a></li>
                    <li><a href="#managingStatus">Managing Notification Status</a></li>
                    <li><a href="#deletingNotifications">Deleting Notifications</a></li>
                    <li><a href="#filteringNotifications">Filtering Notifications</a></li>
                </ul>
            </div>
            <div class="mb-3">
                <h4>ABOUT THIS PAGE</h4>
                <p>This page allows administrators to manage system notifications, send bulk messages to users, and monitor notification activity.</p>
            </div>
            <hr>
            <div id="viewingNotifications">
                <h5>Viewing Notifications</h5>
                <ul>
                    <li>All system notifications are displayed in the main table</li>
                    <li>Use the statistics cards to get an overview of notification activity</li>
                    <li>Click on any notification to view full details</li>
                </ul>
            </div>
            <div id="creatingBulkNotification">
                <h5>Creating Bulk Notifications</h5>
                <ul>
                    <li>Click the "Send Bulk Notification" button</li>
                    <li>Select users or user groups</li>
                    <li>Choose notification type and enter message</li>
                    <li>Review and send to selected users</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container-fluid mt-4">
        <!-- Header Section -->
        <div class="row">
            <div class="col">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h1><i class="fas fa-bell"></i> Notification Management</h1>
                    <div>
                        <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#bulkNotificationModal">
                            <i class="fas fa-paper-plane"></i> Send Bulk Notification
                        </button>
                        <button type="button" class="btn btn-outline-secondary" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample">
                            <i class="fal fa-question-circle"></i> Help
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card bg-primary text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Total Notifications</h6>
                                <h3 id="totalNotifications">-</h3>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-bell fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-warning text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Unread</h6>
                                <h3 id="unreadNotifications">-</h3>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-envelope fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-success text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Recent (7 days)</h6>
                                <h3 id="recentNotifications">-</h3>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-clock fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card bg-info text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Most Common Type</h6>
                                <h6 id="commonType">-</h6>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-chart-bar fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters Section -->
        <div class="row mb-4">
            <div class="col">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Filters</h5>
                        <div class="row">
                            <div class="col-md-3">
                                <label for="filterType" class="form-label">Notification Type</label>
                                <select class="form-select" id="filterType">
                                    <option value="">All Types</option>
                                    <option value="BOOKING_REMINDER">Booking Reminder</option>
                                    <option value="BOOKING_END_REMINDER">End Reminder</option>
                                    <option value="SYSTEM_ANNOUNCEMENT">System Announcement</option>
                                    <option value="MAINTENANCE_NOTICE">Maintenance Notice</option>
                                    <option value="GENERAL">General</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="filterStatus" class="form-label">Status</label>
                                <select class="form-select" id="filterStatus">
                                    <option value="">All Status</option>
                                    <option value="UNREAD">Unread</option>
                                    <option value="READ">Read</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">&nbsp;</label>
                                <div>
                                    <button class="btn btn-primary" onclick="loadNotifications()">
                                        <i class="fas fa-search"></i> Apply Filters
                                    </button>
                                    <button class="btn btn-outline-secondary" onclick="clearFilters()">
                                        <i class="fas fa-times"></i> Clear
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notifications Table -->
        <div class="row">
            <div class="col">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">All Notifications</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="notificationsTable" class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Type</th>
                                        <th>Content</th>
                                        <th>Status</th>
                                        <th>Created</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="notificationsTableBody">
                                    <!-- Data loaded via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bulk Notification Modal -->
    <div class="modal fade" id="bulkNotificationModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Send Bulk Notification</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="bulkNotificationForm">
                        <div class="mb-3">
                            <label for="notificationType" class="form-label">Notification Type</label>
                            <select class="form-select" id="notificationType" required>
                                <option value="">Select Type</option>
                                <option value="SYSTEM_ANNOUNCEMENT">System Announcement</option>
                                <option value="MAINTENANCE_NOTICE">Maintenance Notice</option>
                                <option value="GENERAL">General</option>
                                <option value="URGENT">Urgent</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="notificationMessage" class="form-label">Message</label>
                            <textarea class="form-control" id="notificationMessage" rows="4" required 
                                placeholder="Enter your notification message here..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="userSelection" class="form-label">Send To</label>
                            <select class="form-select" id="userSelection" multiple size="8">
                                <!-- Users loaded via JavaScript -->
                            </select>
                            <div class="form-text">Hold Ctrl/Cmd to select multiple users</div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="selectAllUsers">
                                <label class="form-check-label" for="selectAllUsers">
                                    Select All Users
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="sendBulkNotification()">
                        <i class="fas fa-paper-plane"></i> Send Notification
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="assets/js/jquery.session-timeout.min.js"></script>
    <script src="node_modules/aos/dist/aos.js"></script>
    <script src="node_modules/sweetalert2/dist/sweetalert2.all.min.js"></script>
    <script src="assets/DataTables-2.1.8/datatables.js"></script>
    <script src="assets/js/topNav.js"></script>
    <script src="assets/js/notifications.js"></script>
</body>

</html>